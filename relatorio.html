<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório Personalizado - AI Catalyst</title>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B4F3007RJ5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-B4F3007RJ5');
    </script>
    <link rel="stylesheet" href="styles.css">
    <style>
        .report-page {
            min-height: 100vh;
            background: var(--color-bg-primary);
            padding: var(--spacing-3xl) var(--spacing-xl);
        }
        .report-container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
        }
        .report-header {
            text-align: center;
            margin-bottom: var(--spacing-2xl);
            padding-bottom: var(--spacing-xl);
            border-bottom: 1px solid var(--color-border);
        }
        .report-content {
            line-height: 1.8;
            color: var(--color-text-primary);
        }
        .report-content h1, .report-content h2, .report-content h3 {
            color: var(--color-text-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
        }
        .report-content h1 {
            font-size: 2rem;
            font-weight: 700;
        }
        .report-content h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }
        .report-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
        }
        .report-content p {
            margin-bottom: var(--spacing-md);
        }
        .report-content ul, .report-content ol {
            margin-left: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
        }
        .report-content li {
            margin-bottom: var(--spacing-xs);
        }
        .report-content strong {
            color: var(--color-text-primary);
            font-weight: 600;
        }
        .report-content code {
            background: var(--color-bg-tertiary);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: var(--font-mono);
            font-size: 0.9em;
        }
        .loading-report {
            text-align: center;
            padding: var(--spacing-3xl);
        }
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid var(--color-border);
            border-top-color: var(--color-accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .error-message {
            text-align: center;
            padding: var(--spacing-2xl);
        }
        .error-message h2 {
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-md);
        }
        .error-message p {
            color: var(--color-text-muted);
            margin-bottom: var(--spacing-lg);
        }
    </style>
</head>
<body>
    <div class="report-page">
        <div class="report-container">
            <div class="report-header">
                <h1>Relatório Personalizado de IA</h1>
                <p id="reportDate" style="color: var(--color-text-muted);"></p>
            </div>
            <div id="reportContent" class="report-content">
                <div class="loading-report">
                    <div class="loading-spinner"></div>
                    <p style="margin-top: var(--spacing-md);">Carregando relatório...</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Extrair slug da URL
        // Se a URL for /relatorio/joao-silva-empresa.html
        const pathParts = window.location.pathname.split('/');
        const filename = pathParts[pathParts.length - 1];
        const slug = filename.replace('.html', '');
        
        // URL do webhook do n8n para buscar o relatório (substitua pela sua URL real)
        const N8N_GET_REPORT_URL = 'https://seu-n8n.com/webhook/get-report'; // TODO: Atualizar com sua URL do n8n
        
        // Buscar relatório do n8n
        fetch(`${N8N_GET_REPORT_URL}?slug=${slug}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            if (data.success && data.html) {
                document.getElementById('reportContent').innerHTML = data.html;
                if (data.generatedAt) {
                    document.getElementById('reportDate').textContent = 
                        `Gerado em: ${new Date(data.generatedAt).toLocaleDateString('pt-BR', { 
                            day: '2-digit', 
                            month: '2-digit', 
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        })}`;
                }
            } else {
                throw new Error(data.error || 'Relatório não encontrado');
            }
        })
        .catch(error => {
            console.error('Erro ao carregar relatório:', error);
            document.getElementById('reportContent').innerHTML = `
                <div class="error-message">
                    <h2>Erro ao carregar relatório</h2>
                    <p>${error.message}</p>
                    <a href="/" class="btn btn-primary" style="margin-top: var(--spacing-lg);">
                        Voltar ao início
                    </a>
                </div>
            `;
        });
    </script>
</body>
</html>















